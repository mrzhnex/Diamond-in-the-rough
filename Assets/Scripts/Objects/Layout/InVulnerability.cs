using Assets.Scripts.Manage;
using UnityEngine;

namespace Assets.Scripts.Objects.Layout
{
    [RequireComponent(typeof(LifeForm))]
    public class InVulnerability : MonoBehaviour
    {
        private float Timer = 0.0f;
        private float TimeToRemoveComponent = 4.0f;
        private float TimeToEnableMovement = 0.3f;

        public void Update()
        {
            if (Global.GameStage == GameStage.InGame)
            {
                Timer += Time.deltaTime;
                if (Timer > TimeToRemoveComponent || (Timer > TimeToEnableMovement && (Input.GetMouseButton(0) || Input.GetKey(Global.Settings.Controller.MovementBind.Left) || Input.GetKey(Global.Settings.Controller.MovementBind.Right) || Input.GetKey(Global.Settings.Controller.MovementBind.Up) || Input.GetKey(Global.Settings.Controller.MovementBind.Down) || Input.GetKey(Global.Settings.Controller.MovementBind.Swift))))
                {
                    Global.Debug("Lock doors");
                    MapController.LockTeleportDoors(MapController.CurrentLayout.CurrentRoom);
                    Destroy(GetComponent<InVulnerability>());
                }
            }
        }
    }
}